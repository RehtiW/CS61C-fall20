## 例子:累加器
![[Pasted image 20241203093343.png]]
如果没有寄存器,将无法控制信息流

## 寄存器细节
![[Pasted image 20241203093907.png]]
寄存器是由n个并行的D型触发器(D-type Flip-Flop)构成,由同一时钟信号控制

## 触发器的时序变化(以D触发器为例)
在时钟信号的上升沿,输入d被采样，并传输到输出，在其他时间，d都被忽略
![[Pasted image 20241203094114.png]]
如上图所示
q开头的阴影部分为未定义状态，因为先前没有任何输入信号，视为垃圾状态
在时钟的上升沿，d为0且被采样，在经过延迟之后传输到输出q
![[Pasted image 20241203094325.png]]
因为有着延迟的存在
输入数据必须在"Setup"time+"hold"time时间内保持恒定，这样才能被正确采样并传输到输出端

## 回顾加法器及其波形图细节  
![[Pasted image 20241203094654.png]]

## 最大延迟:Tclk​≥Tmax​
![[Pasted image 20241203095025.png]]
## 插入寄存器以提高时钟频率

流水线通过**插入更多寄存器**来分隔计算任务的阶段，是为了提高处理器的时钟频率和整体性能。寄存器的引入在流水线中有以下几个关键作用：
### **1. 寄存器减少信号传播延迟**

- 在复杂电路中，信号从输入传播到输出需要经过多个逻辑门（例如加法器、乘法器等）。如果不使用寄存器，信号必须在一个时钟周期内完成整个路径。
- 插入寄存器将电路分为多个较小的逻辑段，每段只需处理一部分逻辑操作，减少了**信号传播的总路径长度（critical path）**。
- **关键点**：时钟周期受限于最长的信号路径。通过寄存器分隔，可以缩短最长路径，从而提升时钟频率。
### **2. 寄存器存储中间结果，便于阶段划分**

- 寄存器用于存储流水线各阶段的中间结果。
- 每个阶段（如取指、译码、执行、访存、回写）只负责完成其指定的任务，其结果被存储在寄存器中，传递给下一个阶段。
- 这种分阶段执行避免了任务间的相互干扰，提高了流水线的效率。



### **总结**
## State elements are used to:
úBuild memories
ú Control the flow of information between other state 
elements and combinational logic
## § D-flip-flops used to build registers
## § Clocks tell us when D-flip-flops change
ú setup and hold times are important
## § We pipeline long-delay CL for faster clock
## § Finite state machines extremely useful
ú You’ll see them again 151A, 152, 164, 172, …