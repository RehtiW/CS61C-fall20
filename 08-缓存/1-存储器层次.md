![[Pasted image 20241224145415.png]]
**每一层次都是其次级层次的拷贝**
## If level closer to Processor, it is
### Smaller
### Faster
### More expensive
### subset of lower levels (contains most recently used data)

## 最低层次通常包含所有数据(通常是磁盘)
## 内存层次结构为处理器产生一个非常且快速的内存的幻觉

=====================================================

## 缓存包含当前正在使用的内存数据的副本。

## 内存包含当前正在使用的磁盘数据的副本。

## 缓存的工作原理基于时间局部性和空间局部性。

- **时间局部性（locality in time）**：如果我们现在正在使用某个数据，通常我们很快会再次使用它。
- **空间局部性（locality in space）**：如果我们使用了一块内存数据，通常我们会很快使用到它相邻的数据。

=====================================================

## 如何管理层级
- **寄存器（registers）<-> 内存（memory）**
    
    - **管理者**：由编译器或汇编级程序员管理。
    - **含义**：寄存器是处理器内部的高速存储单元，存储临时的数据或指令。它们的存储容量非常小，但访问速度非常快。相比之下，内存（RAM）具有较大的存储容量，但访问速度相对较慢。**编译器或汇编级程序员可以决定哪些数据应该保存在寄存器中，以提高程序性能。**
- **缓存（cache）<-> 主内存（main memory）**
    
    - **管理者**：由缓存控制硬件管理。
    - **含义**：缓存是用于加速内存访问的高速存储。缓存存储频繁使用的数据，以减少访问主内存的延迟。**缓存控制硬件会根据数据的使用情况决定哪些数据存入缓存**。缓存通常分为多个层次（如L1、L2缓存等），以优化性能。
- **主内存（main memory）<-> 磁盘（磁盘存储，secondary storage）**
    
    - **管理者**：由操作系统管理（通过虚拟内存）。
    - **含义**：主内存（RAM）是计算机系统的主要存储器，存储当前正在使用的程序和数据。磁盘（如硬盘或固态硬盘）是长期存储数据的介质，存储大量数据，但访问速度较慢。**操作系统通过虚拟内存管理将主内存和磁盘之间的数据交换（通过交换空间），允许程序使用比物理内存更多的数据。**
- **虚拟地址到物理地址的映射由硬件辅助（TLB - Translation Lookaside Buffer）**
    
    - **管理者**：硬件（TLB，翻译后备缓冲区）。
    - **含义**：虚拟内存系统允许程序使用比物理内存更大的地址空间。操作系统通过将虚拟地址映射到物理地址来管理内存。**TLB** 是硬件缓存，用于存储最近访问的虚拟地址与物理地址的映射，目的是加速地址转换过程。
- **由程序员管理（通过文件）**
    
    - **管理者**：程序员。
    - **含义**：程序员可以通过文件系统管理存储在磁盘上的数据。文件是操作系统与磁盘交互的基本单位，程序员可以通过读取和写入文件来管理数据。文件存储通常比较慢，但可以存储大量数据。