# TLB(翻译后备缓冲器)
## 为什么需要
为了避免两次DRAM访问，**PTE获取，页表字段获取**
每次 CPU 产生一个虚拟地址，MMU 都要查阅一个 PTE(page table entry)，这带来了额外的开销。
## 位置，基本模型，作用
许多系统**在 MMU 中**包括了一个**关于 PTE 的小的缓存**——翻译后备缓冲器（TLB）。这样所有的**地址翻译步骤在 MMU 中就可以执行完成**。
## 特性
TLB 采用了具有**较高相联度的组相联方式**，用于**组选择和行匹配的索引和标记字段**从虚拟地址的**虚拟页号**中提取出来。
![[Pasted image 20250117213124.png]]
当 TLB 不命中时，MMU 需要**从 L1 高速缓存中取出相应的 PTE 替换 TLB 中的某个已存在的条目。**


# 多级页表
### 为什么需要：
单页表在典型情况即：一个 32 位的地址空间、4KB 的页面、4 字节的 PTE
需要4MB的页表常驻在内存，占用大量内存空间。64位系统更甚
所以引入多级页表

### 原理
**一级页表**的每个 PTE 负责映射虚拟地址空间中的一个4MB的片（一级->虚拟内存空间），
**二级页表**的每个 PTE 映射一个4KB虚拟内存页面。
**注意：使用4字节的PTE，每个一级和二级页表都是4KB字节，刚好和一个页面大小一样**

### 两方面减少内存要求：
#### 一：
如果一级页表中的一个PTE为空，那么**相应的二级页表不会存在**，这代表巨大的潜在节约，因为对于一个典型程序，**4GB的虚拟地址空间的大部分都是未分配的**
#### 二：
**只有一级页表才需要总是在主存中**；虚拟内存系统可以在需要时创建，页面调入或调出二级页表，**只有最经常使用的二级页表**才需要缓存在主存中

### 多级页表虚拟地址翻译
访问k个PTE看起来不切实际，**然而TLB将不同层次页表条目缓存起来**，实际上不比单级页表慢太多
![[Pasted image 20250117215020.png]]


